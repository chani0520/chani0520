## Naver

#### API ÏöîÏ≤≠

- API ÏöîÏ≤≠ ÏÑ±Í≥µÏãú : http://ÏΩúÎ∞±URL/redirect?code={codeÍ∞í}&state={stateÍ∞í}
- API ÏöîÏ≤≠ Ïã§Ìå®Ïãú : http://ÏΩúÎ∞±URL/redirect?state={stateÍ∞í}&error={ÏóêÎü¨ÏΩîÎìúÍ∞í}&error_description={ÏóêÎü¨Î©îÏãúÏßÄ}



#### ÎÑ§Ïù¥Î≤Ñ Î°úÍ∑∏Ïù∏ ÌöåÏõêÏùò ÌîÑÎ°úÌïÑ Ï†ïÎ≥¥ ÏÉÅÏÑ∏

- Ïù¥Ïö©Ïûê ÏãùÎ≥ÑÏûê (ÎÑ§Ïù¥Î≤Ñ IDÍ∞Ä ÏïÑÎãå Í≥†Ïú† ÏãùÎ≥ÑÏûê) : 
  - 64Ïûê Ïù¥ÎÇ¥Î°ú Íµ¨ÏÑ±Îêú BASE64 ÌòïÏãùÏùò Î¨∏ÏûêÏó¥
  - (2021ÎÖÑ 5Ïõî 1Ïùº Ïù¥ÌõÑ ÏÉùÏÑ±Îêú Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖòÎ∂ÄÌÑ∞ Ï†ÅÏö©. Í∏∞Ï°¥ INT64 Í∑úÍ≤©Ïùò Ïà´Ïûê)
- Ïù¥Î¶Ñ
  - 10Ïûê Ïù¥ÎÇ¥Î°ú Íµ¨ÏÑ±Îêú Î¨∏ÏûêÏó¥
- ÎãâÎÑ§ÏûÑ (ÎÑ§Ïù¥Î≤Ñ Î≥ÑÎ™Ö)
  - 20Ïûê Ïù¥ÎÇ¥Î°ú Íµ¨ÏÑ±Îêú Î¨∏ÏûêÏó¥
- ÌîÑÎ°úÌïÑ Ïù¥ÎØ∏ÏßÄ (ÎÑ§Ïù¥Î≤Ñ ÎÇ¥Ï†ïÎ≥¥ ÌîÑÎ°úÌïÑ Ïù¥ÎØ∏ÏßÄ URL)
  - 255Ïûê Ïù¥ÎÇ¥Î°ú Íµ¨ÏÑ±Îêú URL ÌòïÌÉúÏùò Î¨∏ÏûêÏó¥
- Ïù¥Î©îÏùº Ï£ºÏÜå (ÎÑ§Ïù¥Î≤Ñ ÎÇ¥Ï†ïÎ≥¥ Ïù¥Î©îÏùº)
  - Ïù¥Î©îÏùº Í∑úÍ≤©Ïùò Î¨∏ÏûêÏó¥
- ÏÉùÏùº
  - Ïõî-Ïùº (MM-DD) ÌòïÌÉúÏùò Î¨∏ÏûêÏó¥
- Ïó∞Î†πÎåÄ
  - Ïó∞Î†π Íµ¨Í∞ÑÏóê Îî∞Îùº 0-9 / 10-19 / 20-29 / 30-39 / 40-49 / 50-59 / 60- ÏúºÎ°ú ÌëúÌòÑÎêú Î¨∏ÏûêÏó¥
- ÏÑ±Î≥Ñ
  - M/F (ÎÇ®ÏÑ±/Ïó¨ÏÑ±) ÏúºÎ°ú ÌëúÎêú Î¨∏Ïûê
- Ï∂úÏÉùÏó∞ÎèÑ
  - Ïó∞(YYYY) ÌòïÌÉúÏùò Î¨∏ÏûêÏó¥
- Ìú¥ÎåÄÏ†ÑÌôîÎ≤àÌò∏
  - ÎåÄÏâ¨(-)Î•º Ìè¨Ìï®Ìïú Ìú¥ÎåÄÏ†ÑÌôîÎ≤àÌò∏ Î¨∏ÏûêÏó¥



> ÏòàÏãú ) 
>
> - Ïù¥Ïö©Ïûê ÏãùÎ≥ÑÏûê : abcdefgABCDEFG1234567
> - Ïù¥Î¶Ñ : ÎÑ§Ïù¥Î≤Ñ
> - ÎãâÎÑ§ÏûÑ : ÎÑ§Ïù¥Î≤ÑÎãâÎÑ§ÏûÑ
> - ÌîÑÎ°úÌïÑ Ïù¥ÎØ∏ÏßÄ : https://phinf.pstatic.net/.../image.jpg
> - Ïù¥Î©îÏùº Ï£ºÏÜå : naveridlogin@naver.com
> - ÏÉùÏùº : 08-15
> - Ïó∞Î†πÎåÄ : 20-29
> - ÏÑ±Î≥Ñ : F
> - Ï∂úÏÉùÏó∞ÎèÑ : 1900
> - Ìú¥ÎåÄÏ†ÑÌôîÎ≤àÌò∏ : 010-0000-0000
> - ***ÎÑ§Ïù¥Î≤ÑÏóêÏÑú Ï†úÍ≥µÌïòÎäî ÌîÑÎ°úÌïÑ Ï†ïÎ≥¥ Ï§ë "Ïù¥Ïö©Ïûê ÏãùÎ≥ÑÏûê"Î•º Ï†úÏô∏Ìïú ÌîÑÎ°úÌïÑÏ†ïÎ≥¥Îäî ÏÇ¨Ïö©ÏûêÏùò ÏÑ†ÌÉùÏóê Îî∞ÎùºÏÑú Ï†úÍ≥µÏù¥ ÎêòÏßÄ ÏïäÏùÑÏàò ÏûàÏäµÎãàÎã§.***



#### ÎÑ§Ïù¥Î≤Ñ Î°úÍ∑∏Ïù∏ Ïó∞ÎèôÏùÑ ÏúÑÌïú ÌÖåÏù¥Î∏î Íµ¨ÏÑ±

<img src="./img/naver_table.png">



#### TEST

- callback url : http://localhost:3000/api/auth/callback/naver



#### Ï∞∏Í≥†

- [ÎÑ§Ïù¥Î≤Ñ Î°úÍ∑∏Ïù∏-Í∞úÎ∞úÍ∞ÄÏù¥Îìú](https://developers.naver.com/docs/login/devguide/devguide.md#%EB%84%A4%EC%9D%B4%EB%B2%84%20%EB%A1%9C%EA%B7%B8%EC%9D%B8-%EA%B0%9C%EB%B0%9C%EA%B0%80%EC%9D%B4%EB%93%9C)





- NaverLoginBtn.tsx

  ```javascript
  import React, { useEffect } from 'react'
  import Router from 'next/router'
  
  declare global {
    interface Window {
      naver: any
    }
  }
  
  let naverLogin: any
  export default function NaverLogin() {
    useEffect(() => {
      const initNaverLogin = () => {
        const naverLogin = new window.naver.LoginWithNaverId({
          clientId: process.env.NEXT_PUBLIC_NAVER_CLIENT_ID,
          callbackUrl: process.env.NEXT_PUBLIC_NAVER_CALLBACK_URL,
          isPopup: false,
          loginButton: { color: 'green', type: 3, height: 20 },
          callbackHandle: true,
        })
  
        naverLogin.init()
      }
      const getData = () => {
        console.log('===>', window.location.href.includes('access_token'))
        if (window.location.href.includes('access_token')) {
          console.log('We get access_token!')
        } else {
          console.log('We can not get access_token!')
        }
      }
  
      const getToken = () => {
        console.log('üö®üö®üö®üö® getToken called!')
        const hash = Router.asPath.split('#')[1]
        console.log('üö®üö®üö®üö® hash :', hash)
        if (hash) {
          console.log('hash ===> ', hash)
  
          const token = hash.split('=')[1].split('&')[0]
          console.log('token ===> ', token)
  
          naverLogin.getLoginStatus((status: any) => {
            if (status) {
              console.log('status ===> ', status)
              console.log('naverLogin.user ===> ', naverLogin.user)
  
              Router.push({
                pathname: '/api/auth/callback/naver',
                query: {
                  token: token,
                },
              })
            }
          })
        } else {
          console.log('hash is undefined')
        }
      }
      initNaverLogin()
      getData()
    }, [])
  
    return <div id="naverIdLogin" className="text-center w-[200px] mx-auto m-2" />
  }
  
  ```

- src/pages/api/auth/callback/naver.tsx

  ```javascript
  import axios from 'axios'
  import type { NextApiRequest, NextApiResponse } from 'next'
  import { useSession } from 'next-auth/react'
  
  export default function handler(req: NextApiRequest, res: NextApiResponse) {
    const { data, status } = useSession()
    console.log(data, status)
    /**
     * code : ÎÑ§Ïù¥Î≤Ñ Î°úÍ∑∏Ïù∏ Ïù∏Ï¶ùÏóê ÏÑ±Í≥µÌïòÎ©¥ Î∞òÌôòÎ∞õÎäî Ïù∏Ï¶ù ÏΩîÎìú, Ï†ëÍ∑º ÌÜ†ÌÅ∞(access token) Î∞úÍ∏âÏóê ÏÇ¨Ïö©
     * state : ÏÇ¨Ïù¥Ìä∏ Í∞Ñ ÏöîÏ≤≠ ÏúÑÏ°∞ Í≥µÍ≤©ÏùÑ Î∞©ÏßÄÌïòÍ∏∞ ÏúÑÌï¥ Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖòÏóêÏÑú ÏÉùÏÑ±Ìïú ÏÉÅÌÉú ÌÜ†ÌÅ∞ÏúºÎ°ú URL Ïù∏ÏΩîÎî©ÏùÑ Ï†ÅÏö©Ìïú Í∞í
     */
  
    // console.log('üî´ req.query.code ->', req.query.code)
    // console.log('üî´ req.query.state ->', req.query.state)
  
    // let access_token: any
    // axios
    //   .get('https://nid.naver.com/oauth2.0/token', {
    //     params: {
    //       grant_type: 'authorization_code',
    //       client_id: process.env.NEXT_PUBLIC_NAVER_CLIENT_ID,
    //       client_secret: process.env.NEXT_PUBLIC_NAVER_CLIENT_SECRET,
    //       code: req.query.code,
    //       state: req.query.state,
    //     },
    //   })
    //   .then((res) => {
    //     access_token = res.data.access_token
    //     console.log('üî´ res.data.access_token ->', res.data.access_token)
    //   })
    //   .catch((err) => {
    //     console.log(err)
    //   })
  
    // // res.status(200).redirect('/')
  
    // res.status(200).json({
    //   code: req.query.code,
    //   state: req.query.state,
    //   access_token: access_token,
    // })
  
    // console.log('üî´ req ->', req)
  
    return res.status(200).redirect('/')
  }
  
  ```

  



```
curl  -XGET "https://openapi.naver.com/v1/nid/me" \
      -H "Authorization: Bearer AAAAOZU52esvkKAtm3s4YTasvMed70AohrnpoRTh7DLv9NdsQeSoFepFRdGHFMQMKAJ-RwFIdiQxWwJzT_MNFky1kbM
```



---



# Next-Auth Naver

```javascript
üî´ async signIn!
user : {
  id: 'Wab0OMx2OE6DH_zLrMDaMVZhQLSBjA6B3voYwOJLkZM',
  name: 'ÍπÄÏ∞¨',
  email: 'bibis0520@naver.com',
  image: undefined
}
account : {
  provider: 'naver',
  type: 'oauth',
  providerAccountId: 'Wab0OMx2OE6DH_zLrMDaMVZhQLSBjA6B3voYwOJLkZM',
  access_token: 'AAAAOZ3LWO3xzkNOfXNUE2W9AXbgxk2J69pTNBt8c7gsUM7tFONvc8fzLD5ZzjkzCAeZW5ai5BJuWrJ2u2Wvar8gGSA',
  refresh_token: 'Yg4csbFhoyiiYrkxq6DcisV06IgKPDBZ8ot4n7lipEBJQkfaBN45uLgafBlip5nii96isFRmTYqVm2hnooxLjbii3DYIqz2NrTs1Mz1eHBqAIipH0Dip056YfFeDCpCDQKiiEDK6OF',
  token_type: 'bearer',
  expires_at: 1653027548
}
profile : {
  resultcode: '00',
  message: 'success',
  response: {
    id: 'Wab0OMx2OE6DH_zLrMDaMVZhQLSBjA6B3voYwOJLkZM',
    email: 'bibis0520@naver.com',
    mobile: '010-2376-0765',
    mobile_e164: '+821023760765',
    name: 'ÍπÄÏ∞¨'
  }
}
email : undefined
credentials : undefined

üî´ async redirect!
url : http://localhost:3000
baseUrl : http://localhost:3000

üî´ async session!
session : {
  user: { name: 'ÍπÄÏ∞¨', email: 'bibis0520@naver.com', image: undefined },
  expires: '2022-06-19T05:19:10.825Z'
}
user : undefined
token : {
  name: 'ÍπÄÏ∞¨',
  email: 'bibis0520@naver.com',
  sub: 'Wab0OMx2OE6DH_zLrMDaMVZhQLSBjA6B3voYwOJLkZM',
  iat: 1653023949,
  exp: 1655615949,
  jti: 'f6c236a3-334f-4b7e-9e02-d18fe8fd7a44'
}

üî´ async jwt!
token : {
  name: 'ÍπÄÏ∞¨',
  email: 'bibis0520@naver.com',
  picture: undefined,
  sub: 'Wab0OMx2OE6DH_zLrMDaMVZhQLSBjA6B3voYwOJLkZM'
}
user : {
  id: 'Wab0OMx2OE6DH_zLrMDaMVZhQLSBjA6B3voYwOJLkZM',
  name: 'ÍπÄÏ∞¨',
  email: 'bibis0520@naver.com',
  image: undefined
}
account : {
  provider: 'naver',
  type: 'oauth',
  providerAccountId: 'Wab0OMx2OE6DH_zLrMDaMVZhQLSBjA6B3voYwOJLkZM',
  access_token: 'AAAAOZ3LWO3xzkNOfXNUE2W9AXbgxk2J69pTNBt8c7gsUM7tFONvc8fzLD5ZzjkzCAeZW5ai5BJuWrJ2u2Wvar8gGSA',
  refresh_token: 'Yg4csbFhoyiiYrkxq6DcisV06IgKPDBZ8ot4n7lipEBJQkfaBN45uLgafBlip5nii96isFRmTYqVm2hnooxLjbii3DYIqz2NrTs1Mz1eHBqAIipH0Dip056YfFeDCpCDQKiiEDK6OF',
  token_type: 'bearer',
  expires_at: 1653027548
}
profile : {
  resultcode: '00',
  message: 'success',
  response: {
    id: 'Wab0OMx2OE6DH_zLrMDaMVZhQLSBjA6B3voYwOJLkZM',
    email: 'bibis0520@naver.com',
    mobile: '010-2376-0765',
    mobile_e164: '+821023760765',
    name: 'ÍπÄÏ∞¨'
  }
}
isNewUser : undefined
```



# Next-Auth Google

```javascript
üî´ async signIn!
user : {
  id: '110491656816200541479',
  name: 'Î≥¥Î¶¨ÌòïÎãò BoriBro',
  email: 'kimchan0765@gmail.com',
  image: 'https://lh3.googleusercontent.com/a-/AOh14Gi1rFfa4W6PdIU6nueMIR_-kdmEXxtgviT2ge1I3JE=s96-c'
}
account : {
  provider: 'google',
  type: 'oauth',
  providerAccountId: '110491656816200541479',
  access_token: 'ya29.a0ARrdaM-holfkmjOtIWSO4cicuW2YNTesOIxT4svvRIULTfLv_l02maKCjO-k44u6KQZqUCLxa9kUCYBQwmUUKq8DHX3Jcq-iLDwSGk1J3SQyJn6vCYptQtD22gwycccd9yd3D2qzKvh322YPT5X3qFw88jri',
  expires_at: 1653027626,
  scope: 'https://www.googleapis.com/auth/userinfo.profile openid https://www.googleapis.com/auth/userinfo.email',
  token_type: 'Bearer',
  id_token: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjQ4NmYxNjQ4MjAwNWEyY2RhZjI2ZDkyMTQwMThkMDI5Y2E0NmZiNTYiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiI4NzQ3MTc1NDY5MjctamYzYWJxcTM4a3E5Y2RxdWRrZ20wcmpsa3RmdDl1NW8uYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJhdWQiOiI4NzQ3MTc1NDY5MjctamYzYWJxcTM4a3E5Y2RxdWRrZ20wcmpsa3RmdDl1NW8uYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJzdWIiOiIxMTA0OTE2NTY4MTYyMDA1NDE0NzkiLCJlbWFpbCI6ImtpbWNoYW4wNzY1QGdtYWlsLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJhdF9oYXNoIjoiWlpyVUlfS0o1VlFlOUVNLTd3ZnVqdyIsIm5hbWUiOiLrs7TrpqztmJXri5ggQm9yaUJybyIsInBpY3R1cmUiOiJodHRwczovL2xoMy5nb29nbGV1c2VyY29udGVudC5jb20vYS0vQU9oMTRHaTFyRmZhNFc2UGRJVTZudWVNSVJfLWtkbUVYeHRndmlUMmdlMUkzSkU9czk2LWMiLCJnaXZlbl9uYW1lIjoi67O066as7ZiV64uYIEJvcmlCcm8iLCJsb2NhbGUiOiJrbyIsImlhdCI6MTY1MzAyNDAyNywiZXhwIjoxNjUzMDI3NjI3fQ.G_kzOO5W6ahCOFeuPuMXMqGfrraYUxTSNjjRGd8bNpF10o6njtUlG0ijZ19AwwJSQX8LdaZUmhotjfnUjkzSJRoG35xASQYOQ0u6y3AE-uQDAh2uug_EmdWfSfq5cNksHNB606nEr1tXmbWf2WYxUXgyzlC3k4JG5vOrqszV14APe-SKCJF_I6xt8f9NcpN45bNpGepkrkc3VcbodCbmeXndCRYroY21tYEHJd5m2EZmjCpMo_3JDGvcaOPrIJ_AZYUI5ZRge-RtVD5McTi-JG0hsoVATwSClWdgympeVSW-qcbkwcnN9KKHW_u1nwYb0Bi64wrJLogYoDOmigK0mg'
}
profile : {
  iss: 'https://accounts.google.com',
  azp: '874717546927-jf3abqq38kq9cdqudkgm0rjlktft9u5o.apps.googleusercontent.com',
  aud: '874717546927-jf3abqq38kq9cdqudkgm0rjlktft9u5o.apps.googleusercontent.com',
  sub: '110491656816200541479',
  email: 'kimchan0765@gmail.com',
  email_verified: true,
  at_hash: 'ZZrUI_KJ5VQe9EM-7wfujw',
  name: 'Î≥¥Î¶¨ÌòïÎãò BoriBro',
  picture: 'https://lh3.googleusercontent.com/a-/AOh14Gi1rFfa4W6PdIU6nueMIR_-kdmEXxtgviT2ge1I3JE=s96-c',
  given_name: 'Î≥¥Î¶¨ÌòïÎãò BoriBro',
  locale: 'ko',
  iat: 1653024027,
  exp: 1653027627
}
email : undefined
credentials : undefined

üî´ async redirect!
url : http://localhost:3000
baseUrl : http://localhost:3000

üî´ async session!
session : {
  user: {
    name: 'Î≥¥Î¶¨ÌòïÎãò BoriBro',
    email: 'kimchan0765@gmail.com',
    image: 'https://lh3.googleusercontent.com/a-/AOh14Gi1rFfa4W6PdIU6nueMIR_-kdmEXxtgviT2ge1I3JE=s96-c'
  },
  expires: '2022-06-19T05:20:29.447Z'
}
user : undefined
token : {
  name: 'Î≥¥Î¶¨ÌòïÎãò BoriBro',
  email: 'kimchan0765@gmail.com',
  picture: 'https://lh3.googleusercontent.com/a-/AOh14Gi1rFfa4W6PdIU6nueMIR_-kdmEXxtgviT2ge1I3JE=s96-c',
  sub: '110491656816200541479',
  iat: 1653024027,
  exp: 1655616027,
  jti: '673f92d0-463e-41ad-b4bc-1851ce7e424b'
}

üî´ async jwt!
token : {
  name: 'Î≥¥Î¶¨ÌòïÎãò BoriBro',
  email: 'kimchan0765@gmail.com',
  picture: 'https://lh3.googleusercontent.com/a-/AOh14Gi1rFfa4W6PdIU6nueMIR_-kdmEXxtgviT2ge1I3JE=s96-c',
  sub: '110491656816200541479'
}
user : {
  id: '110491656816200541479',
  name: 'Î≥¥Î¶¨ÌòïÎãò BoriBro',
  email: 'kimchan0765@gmail.com',
  image: 'https://lh3.googleusercontent.com/a-/AOh14Gi1rFfa4W6PdIU6nueMIR_-kdmEXxtgviT2ge1I3JE=s96-c'
}
account : {
  provider: 'google',
  type: 'oauth',
  providerAccountId: '110491656816200541479',
  access_token: 'ya29.a0ARrdaM-holfkmjOtIWSO4cicuW2YNTesOIxT4svvRIULTfLv_l02maKCjO-k44u6KQZqUCLxa9kUCYBQwmUUKq8DHX3Jcq-iLDwSGk1J3SQyJn6vCYptQtD22gwycccd9yd3D2qzKvh322YPT5X3qFw88jri',
  expires_at: 1653027626,
  scope: 'https://www.googleapis.com/auth/userinfo.profile openid https://www.googleapis.com/auth/userinfo.email',
  token_type: 'Bearer',
  id_token: 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjQ4NmYxNjQ4MjAwNWEyY2RhZjI2ZDkyMTQwMThkMDI5Y2E0NmZiNTYiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiI4NzQ3MTc1NDY5MjctamYzYWJxcTM4a3E5Y2RxdWRrZ20wcmpsa3RmdDl1NW8uYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJhdWQiOiI4NzQ3MTc1NDY5MjctamYzYWJxcTM4a3E5Y2RxdWRrZ20wcmpsa3RmdDl1NW8uYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJzdWIiOiIxMTA0OTE2NTY4MTYyMDA1NDE0NzkiLCJlbWFpbCI6ImtpbWNoYW4wNzY1QGdtYWlsLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJhdF9oYXNoIjoiWlpyVUlfS0o1VlFlOUVNLTd3ZnVqdyIsIm5hbWUiOiLrs7TrpqztmJXri5ggQm9yaUJybyIsInBpY3R1cmUiOiJodHRwczovL2xoMy5nb29nbGV1c2VyY29udGVudC5jb20vYS0vQU9oMTRHaTFyRmZhNFc2UGRJVTZudWVNSVJfLWtkbUVYeHRndmlUMmdlMUkzSkU9czk2LWMiLCJnaXZlbl9uYW1lIjoi67O066as7ZiV64uYIEJvcmlCcm8iLCJsb2NhbGUiOiJrbyIsImlhdCI6MTY1MzAyNDAyNywiZXhwIjoxNjUzMDI3NjI3fQ.G_kzOO5W6ahCOFeuPuMXMqGfrraYUxTSNjjRGd8bNpF10o6njtUlG0ijZ19AwwJSQX8LdaZUmhotjfnUjkzSJRoG35xASQYOQ0u6y3AE-uQDAh2uug_EmdWfSfq5cNksHNB606nEr1tXmbWf2WYxUXgyzlC3k4JG5vOrqszV14APe-SKCJF_I6xt8f9NcpN45bNpGepkrkc3VcbodCbmeXndCRYroY21tYEHJd5m2EZmjCpMo_3JDGvcaOPrIJ_AZYUI5ZRge-RtVD5McTi-JG0hsoVATwSClWdgympeVSW-qcbkwcnN9KKHW_u1nwYb0Bi64wrJLogYoDOmigK0mg'
}
profile : {
  iss: 'https://accounts.google.com',
  azp: '874717546927-jf3abqq38kq9cdqudkgm0rjlktft9u5o.apps.googleusercontent.com',
  aud: '874717546927-jf3abqq38kq9cdqudkgm0rjlktft9u5o.apps.googleusercontent.com',
  sub: '110491656816200541479',
  email: 'kimchan0765@gmail.com',
  email_verified: true,
  at_hash: 'ZZrUI_KJ5VQe9EM-7wfujw',
  name: 'Î≥¥Î¶¨ÌòïÎãò BoriBro',
  picture: 'https://lh3.googleusercontent.com/a-/AOh14Gi1rFfa4W6PdIU6nueMIR_-kdmEXxtgviT2ge1I3JE=s96-c',
  given_name: 'Î≥¥Î¶¨ÌòïÎãò BoriBro',
  locale: 'ko',
  iat: 1653024027,
  exp: 1653027627
}
isNewUser : undefined
```



# Next-Auth Kakao

```javascript
üî´ async signIn!
user : {
  id: '2249925158',
  name: 'ChanKim',
  email: 'rlacks0765@naver.com',
  image: undefined
}
account : {
  provider: 'kakao',
  type: 'oauth',
  providerAccountId: '2249925158',
  access_token: 'VmxdmeQX0OO4W14-USbI8vnko7ZXklWrKc5E_V1uCj1zGAAAAYDf6lEE',
  token_type: 'bearer',
  refresh_token: 'hFG2kLrKJbas7diC1jJmioWWHAbsF7JzvnitsnLXCj1zGAAAAYDf6lED',
  expires_at: 1653045715,
  scope: 'account_email profile_nickname',
  refresh_token_expires_in: 5183999
}
profile : {
  id: 2249925158,
  connected_at: '2022-05-20T04:59:19Z',
  properties: { nickname: 'ChanKim' },
  kakao_account: {
    profile_nickname_needs_agreement: false,
    profile: { nickname: 'ChanKim' },
    has_email: true,
    email_needs_agreement: false,
    is_email_valid: true,
    is_email_verified: true,
    email: 'rlacks0765@naver.com'
  }
}
email : undefined
credentials : undefined

üî´ async redirect!
url : http://localhost:3000
baseUrl : http://localhost:3000

üî´ async session!
session : {
  user: { name: 'ChanKim', email: 'rlacks0765@naver.com', image: undefined },
  expires: '2022-06-19T05:21:58.455Z'
}
user : undefined
token : {
  name: 'ChanKim',
  email: 'rlacks0765@naver.com',
  sub: '2249925158',
  iat: 1653024116,
  exp: 1655616116,
  jti: 'c089a25a-e14c-4154-8481-578c1c682cfd'
}

üî´ async jwt!
token : {
  name: 'ChanKim',
  email: 'rlacks0765@naver.com',
  sub: '2249925158',
  iat: 1653024116,
  exp: 1655616116,
  jti: 'c089a25a-e14c-4154-8481-578c1c682cfd'
}
user : {
  id: '2249925158',
  name: 'ChanKim',
  email: 'rlacks0765@naver.com',
  image: undefined
}
account : {
  provider: 'kakao',
  type: 'oauth',
  providerAccountId: '2249925158',
  access_token: 'VmxdmeQX0OO4W14-USbI8vnko7ZXklWrKc5E_V1uCj1zGAAAAYDf6lEE',
  token_type: 'bearer',
  refresh_token: 'hFG2kLrKJbas7diC1jJmioWWHAbsF7JzvnitsnLXCj1zGAAAAYDf6lED',
  expires_at: 1653045715,
  scope: 'account_email profile_nickname',
  refresh_token_expires_in: 5183999
}
profile : {
  id: 2249925158,
  connected_at: '2022-05-20T04:59:19Z',
  properties: { nickname: 'ChanKim' },
  kakao_account: {
    profile_nickname_needs_agreement: false,
    profile: { nickname: 'ChanKim' },
    has_email: true,
    email_needs_agreement: false,
    is_email_valid: true,
    is_email_verified: true,
    email: 'rlacks0765@naver.com'
  }
}
isNewUser : undefined
```

---









# 2022/05/24

# Kakao SDKÏÇ¨Ïö©Ìï¥ÏÑú Î°úÍ∑∏Ïù∏ Í∏∞Îä• ÎßåÎì§Í∏∞

- blue berry ÏÖãÌåÖ Î≥ÄÍ≤Ω 

  - ÌöåÏõêÍ∞ÄÏûÖ ÏøºÎ¶¨ ( cmd : create-sns )  

    ```mysql
    // ASIS
    insert into Customer set name=:name, mobile=:mobile, email=:email, passwd=sha2(:passwd, 512)
    
    // TOBE
    insert into Customer set name=:name, email=:email, provider=:provider, provideraccid=:provideraccid
    ```

    

  - Î°úÍ∑∏Ïù∏ ÏøºÎ¶¨ ( cmd : login-sns )

    ```mysql
    select id, name, mobile, email, level as auth, level as role, fmctoken, provider
    from Customer
    where email=:email
      and provider=:provider
      and provideraccid=:provideraccid
      
      
      
    -- sub query = with_logindt
    update Customer set logindt = current_timestamp(), fcmtoken=ifnull(:fcmtoken, fcmtoken)
    where id = :main.id
    ```

    

  

  







































